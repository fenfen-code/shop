(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f5aecbc0"],{"0cb2":function(e,t,a){var r=a("7b0b"),s=Math.floor,o="".replace,n=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,i=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,a,l,c,d){var u=a+e.length,m=l.length,p=i;return void 0!==c&&(c=r(c),p=n),o.call(d,p,(function(r,o){var n;switch(o.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,a);case"'":return t.slice(u);case"<":n=c[o.slice(1,-1)];break;default:var i=+o;if(0===i)return r;if(i>m){var d=s(i/10);return 0===d?r:d<=m?void 0===l[d-1]?o.charAt(1):l[d-1]+o.charAt(1):r}n=l[i-1]}return void 0===n?"":n}))}},"26b9":function(e,t,a){"use strict";a("44e3")},"44e3":function(e,t,a){},5319:function(e,t,a){"use strict";var r=a("d784"),s=a("d039"),o=a("825a"),n=a("a691"),i=a("50c4"),l=a("577e"),c=a("1d80"),d=a("8aa5"),u=a("0cb2"),m=a("14c3"),p=a("b622"),g=p("replace"),f=Math.max,v=Math.min,b=function(e){return void 0===e?e:String(e)},h=function(){return"$0"==="a".replace(/./,"$0")}(),_=function(){return!!/./[g]&&""===/./[g]("a","$0")}(),x=!s((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}));r("replace",(function(e,t,a){var r=_?"$":"$0";return[function(e,a){var r=c(this),s=void 0==e?void 0:e[g];return void 0!==s?s.call(e,r,a):t.call(l(r),e,a)},function(e,s){var c=o(this),p=l(e);if("string"===typeof s&&-1===s.indexOf(r)&&-1===s.indexOf("$<")){var g=a(t,c,p,s);if(g.done)return g.value}var h="function"===typeof s;h||(s=l(s));var _=c.global;if(_){var x=c.unicode;c.lastIndex=0}var w=[];while(1){var k=m(c,p);if(null===k)break;if(w.push(k),!_)break;var $=l(k[0]);""===$&&(c.lastIndex=d(p,i(c.lastIndex),x))}for(var I="",F=0,y=0;y<w.length;y++){k=w[y];for(var G=l(k[0]),L=f(v(n(k.index),p.length),0),V=[],R=1;R<k.length;R++)V.push(b(k[R]));var P=k.groups;if(h){var O=[G].concat(V,L,p);void 0!==P&&O.push(P);var j=l(s.apply(void 0,O))}else j=u(G,p,L,V,P,s);L>=F&&(I+=p.slice(F,L)+j,F=L+G.length)}return I+p.slice(F)}]}),!x||!h||_)},a870:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/home"}},nativeOn:{click:function(t){return e.clearStorage.apply(null,arguments)}}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("商品管理")]),a("el-breadcrumb-item",[e._v("添加商品")])],1),a("el-card",[a("el-alert",{attrs:{title:"添加商品信息",type:"info",center:"","show-icon":""}}),a("el-steps",{attrs:{space:200,active:e.activeIndex-0,"finish-status":"success","align-center":""}},[a("el-step",{attrs:{title:"基本信息"}}),a("el-step",{attrs:{title:"商品参数"}}),a("el-step",{attrs:{title:"商品属性"}}),a("el-step",{attrs:{title:"商品图片"}}),a("el-step",{attrs:{title:"商品内容"}}),a("el-step",{attrs:{title:"完成"}})],1),a("el-form",{ref:"addFormRefs",attrs:{"label-width":"80px",model:e.addGoodsForm,rules:e.addFormRules,"label-position":"top"}},[a("el-tabs",{attrs:{"tab-position":"left","before-leave":e.beforeTabLeave},on:{"tab-click":e.handleTabClick},model:{value:e.activeIndex,callback:function(t){e.activeIndex=t},expression:"activeIndex"}},[a("el-tab-pane",{attrs:{label:"基本信息",name:"0"}},[a("el-form-item",{attrs:{label:"商品名称",prop:"goods_name"}},[a("el-input",{model:{value:e.addGoodsForm.goods_name,callback:function(t){e.$set(e.addGoodsForm,"goods_name",t)},expression:"addGoodsForm.goods_name"}})],1),a("el-form-item",{attrs:{label:"商品价格",prop:"goods_price"}},[a("el-input",{model:{value:e.addGoodsForm.goods_price,callback:function(t){e.$set(e.addGoodsForm,"goods_price",t)},expression:"addGoodsForm.goods_price"}})],1),a("el-form-item",{attrs:{label:"商品数量",prop:"goods_number"}},[a("el-input",{model:{value:e.addGoodsForm.goods_number,callback:function(t){e.$set(e.addGoodsForm,"goods_number",t)},expression:"addGoodsForm.goods_number"}})],1),a("el-form-item",{attrs:{label:"商品重量",prop:"goods_weight"}},[a("el-input",{model:{value:e.addGoodsForm.goods_weight,callback:function(t){e.$set(e.addGoodsForm,"goods_weight",t)},expression:"addGoodsForm.goods_weight"}})],1),a("el-form-item",{attrs:{label:"商品分类"}},[a("el-cascader",{attrs:{options:e.cateList,props:e.cateProps},on:{change:e.casChange},model:{value:e.selectVal,callback:function(t){e.selectVal=t},expression:"selectVal"}})],1)],1),a("el-tab-pane",{attrs:{label:"商品参数",name:"1"}},e._l(e.manyList,(function(t){return a("el-form-item",{key:t.attr_id,attrs:{label:t.attr_name}},[a("el-checkbox-group",{model:{value:t.attr_vals,callback:function(a){e.$set(t,"attr_vals",a)},expression:"item.attr_vals"}},e._l(t.attr_vals,(function(e,t){return a("el-checkbox",{key:t,attrs:{label:e}})})),1)],1)})),1),a("el-tab-pane",{attrs:{label:"商品属性",name:"2"}},e._l(e.onlyList,(function(t){return a("el-form-item",{key:t.attr_id,attrs:{label:t.attr_name}},[a("el-input",{model:{value:t.attr_vals,callback:function(a){e.$set(t,"attr_vals",a)},expression:"item.attr_vals"}})],1)})),1),a("el-tab-pane",{attrs:{label:"商品图片",name:"3"}},[a("el-upload",{attrs:{action:e.upLoadImageUrl,"on-preview":e.handlePreview,"on-remove":e.imageRemove,"list-type":"picture",headers:e.headerObj,"on-success":e.imageSuccess}},[a("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")])],1)],1),a("el-tab-pane",{attrs:{label:"商品内容",name:"4"}},[e._v("、 "),a("quill-editor",{model:{value:e.addGoodsForm.goods_introduce,callback:function(t){e.$set(e.addGoodsForm,"goods_introduce",t)},expression:"addGoodsForm.goods_introduce"}}),a("el-button",{attrs:{type:"primary"},on:{click:e.addGoods}},[e._v("添加商品")])],1)],1)],1),a("el-dialog",{attrs:{title:"图片预览",visible:e.previewImageVisible,width:"50%"},on:{"update:visible":function(t){e.previewImageVisible=t},close:e.resetImagePath}},[a("img",{staticClass:"previewImage",attrs:{src:e.previewImagePath}})])],1)],1)},s=[],o=a("1da1"),n=(a("159b"),a("ac1f"),a("1276"),a("c740"),a("a434"),a("a15b"),a("5319"),a("96cf"),{data:function(){return{upLoadImageUrl:"http://127.0.0.1:8888/api/private/v1/upload",activeIndex:"0",addGoodsForm:{goods_name:"",goods_cat:"",goods_price:0,goods_number:0,goods_weight:0,goods_introduce:"",pics:[],attrs:[]},cateList:[],cateProps:{expandTrigger:"hover",value:"cat_id",label:"cat_name",children:"children"},headerObj:{Authorization:window.sessionStorage.getItem("token")},manyList:[],onlyList:[],selectVal:[],addFormRules:{goods_name:[{required:!0,message:"不能为空",trigger:"blur"}],goods_price:[{required:!0,message:"不能为空",trigger:"blur"}],goods_number:[{required:!0,message:"不能为空",trigger:"blur"}],goods_weight:[{required:!0,message:"不能为空",trigger:"blur"}],goods_cat:[{required:!0,message:"不能为空",trigger:"blur"}]},previewImagePath:"",previewImageVisible:!1}},created:function(){this.getCateList()},methods:{clearStorage:function(){window.sessionStorage.setItem("activePath",""),this.$router.go(0)},getCateList:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("categories");case 2:if(a=t.sent,r=a.data,200===r.meta.status){t.next=6;break}return t.abrupt("return",e.$message.error("获取数据失败"));case 6:e.cateList=r.data;case 7:case"end":return t.stop()}}),t)})))()},casChange:function(){3!==this.selectVal.length&&(this.selectVal=[])},beforeTabLeave:function(e,t){if("0"===t&&0===this.selectVal.length)return this.$message.error("请选择商品分类"),!1},handleTabClick:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a,r,s,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("1"!==e.activeIndex){t.next=9;break}return t.next=3,e.$http.get("categories/".concat(e.selectVal[2],"/attributes"),{params:{sel:"many"}});case 3:if(a=t.sent,r=a.data,200===r.meta.status){t.next=7;break}return t.abrupt("return",e.$message.error("获取数据失败"));case 7:r.data.forEach((function(e){e.attr_vals=e.attr_vals?e.attr_vals.split(" "):[]})),e.manyList=r.data;case 9:if("2"!==e.activeIndex){t.next=17;break}return t.next=12,e.$http.get("categories/".concat(e.selectVal[2],"/attributes"),{params:{sel:"only"}});case 12:if(s=t.sent,o=s.data,200===o.meta.status){t.next=16;break}return t.abrupt("return",e.$message.error("获取数据失败"));case 16:e.onlyList=o.data;case 17:case"end":return t.stop()}}),t)})))()},handlePreview:function(e){this.previewImagePath=e.response.data.url,this.previewImageVisible=!0},imageSuccess:function(e){this.addGoodsForm.pics.push({pic:e.data.tmp_path})},imageRemove:function(e){var t=e.resopnse.data.tmp_path,a=this.addGoodsForm.pics.findIndex((function(e){return e.pic===t}));this.addGoodsForm.pics.splice(a,1)},resetImagePath:function(){this.previewImagePath=""},addGoods:function(){var e=this;this.$refs.addFormRefs.validate(function(){var t=Object(o["a"])(regeneratorRuntime.mark((function t(a){var r,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a){t.next=2;break}return t.abrupt("return",e.$message.error("提交信息有误"));case 2:return e.addGoodsForm.goods_cat=e.selectVal.join(","),e.manyList.forEach((function(t){e.addGoodsForm.attrs.push({attr_id:t.attr_id,attr_value:t.attr_vals.join(" ")})})),e.onlyList.forEach((function(t){e.addGoodsForm.attrs.push({attr_id:t.attr_id,attr_value:t.attr_vals})})),t.next=7,e.$http.post("goods",e.addGoodsForm);case 7:if(r=t.sent,s=r.data,201===s.meta.status){t.next=11;break}return t.abrupt("return",e.$message.error(s.meta.msg));case 11:e.$message.success(s.meta.msg),e.$router.replace("/goods");case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}}),i=n,l=(a("26b9"),a("2877")),c=Object(l["a"])(i,r,s,!1,null,null,null);t["default"]=c.exports},c740:function(e,t,a){"use strict";var r=a("23e7"),s=a("b727").findIndex,o=a("44d2"),n="findIndex",i=!0;n in[]&&Array(1)[n]((function(){i=!1})),r({target:"Array",proto:!0,forced:i},{findIndex:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}}),o(n)}}]);
//# sourceMappingURL=chunk-f5aecbc0.e066e5ca.js.map